import{S as Slot}from"./Primitive.DurlyzDV.js";import{g as unrefElement}from"./useForwardExpose.Ct4MH066.js";import{h as ref,k as computed,Y as inject,d as defineComponent,j as watchEffect,al as markRaw,Q as h,s as watch,Z as provide}from"./runtime-core.esm-bundler.T-J3b-OY.js";function usePrimitiveElement(){const primitiveElement=ref(),currentElement=computed(()=>["#text","#comment"].includes(primitiveElement.value?.$el.nodeName)?primitiveElement.value?.$el.nextElementSibling:unrefElement(primitiveElement));return{primitiveElement,currentElement}}const ITEM_DATA_ATTR="data-reka-collection-item";function useCollection(options={}){const{key="",isProvider=!1}=options,injectionKey=`${key}CollectionProvider`;let context;if(isProvider){const itemMap=ref(new Map);context={collectionRef:ref(),itemMap},provide(injectionKey,context)}else context=inject(injectionKey);const getItems=(includeDisabledItem=!1)=>{const collectionNode=context.collectionRef.value;if(!collectionNode)return[];const orderedNodes=Array.from(collectionNode.querySelectorAll(`[${ITEM_DATA_ATTR}]`)),orderedItems=Array.from(context.itemMap.value.values()).sort((a,b)=>orderedNodes.indexOf(a.ref)-orderedNodes.indexOf(b.ref));return includeDisabledItem?orderedItems:orderedItems.filter(i=>i.ref.dataset.disabled!=="")},CollectionSlot=defineComponent({name:"CollectionSlot",setup(_,{slots}){const{primitiveElement,currentElement}=usePrimitiveElement();return watch(currentElement,()=>{context.collectionRef.value=currentElement.value}),()=>h(Slot,{ref:primitiveElement},slots)}}),CollectionItem=defineComponent({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(props,{slots,attrs}){const{primitiveElement,currentElement}=usePrimitiveElement();return watchEffect(cleanupFn=>{if(currentElement.value){const key$1=markRaw(currentElement.value);context.itemMap.value.set(key$1,{ref:currentElement.value,value:props.value}),cleanupFn(()=>context.itemMap.value.delete(key$1))}}),()=>h(Slot,{...attrs,[ITEM_DATA_ATTR]:"",ref:primitiveElement},slots)}}),reactiveItems=computed(()=>Array.from(context.itemMap.value.values())),itemMapSize=computed(()=>context.itemMap.value.size);return{getItems,reactiveItems,itemMapSize,CollectionSlot,CollectionItem}}export{usePrimitiveElement as a,useCollection as u};
